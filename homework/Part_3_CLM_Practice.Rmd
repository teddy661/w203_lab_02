---
title: "Part_3: CLM Practice"
author: 'The Principal Components'
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse) 
library(stargazer)
library(sandwich)
library(lmtest)
library(dplyr)

```
```{r}
?read.delim
video <- read.delim('videos.txt', header=TRUE, sep='\t', dec = ".", na.strings = "NA")
head(video)
nrow(video)
ncol(video)
```
```{r}
video <- video %>% 
  mutate(ln_views = log(views))
```

```{r warning=FALSE, out.height= 100%, out.width=100%}
# To assemble multiple plots
library(gridExtra)

p1 <- ggplot(data = video, aes(x = video$rate)) +
  geom_histogram(bins = 30) +
  scale_x_continuous(breaks = seq(0,20,5))+
  labs(title = "Histogram of Rate",x = "Rate",y = "Count")


p2 <- ggplot(data = video, aes(x = video$length)) +
  geom_histogram(bins = 30) +
  scale_x_continuous(breaks = seq(0,30,2))+
  labs(title = "Histogram of Views ", x = "Views", y = "Count")


p3 <- ggplot(data = video, aes(x = video$rate, y = video$ln_views)) +
  geom_point() +
  geom_smooth(se = FALSE) +
  labs(title = "Association between log Views and Rate", x = "Rate", y = "Log Views")


p4 <- ggplot(data = video, aes(x = video$length, y = video$ln_views)) +
  geom_point() +
  geom_smooth(se = FALSE) +
  labs(title = "Association between log Views and Length", x = "Rate", y = "Log Views")

grid.arrange(p1, p2,p3,p4, nrow = 2, ncol = 2)
```


```{r linear regression}
lm_video = lm(ln_views ~ rate + length, data = video)

#check on Robust Standard Error
ses = diag(vcovHC(lm_video))^0.5
#stargazer doesn't correct for robust errors by default;set se=ses to override with the robust errors
stargazer(lm_video, type = 'text', title = "Video Views Model",
          se = list(ses), omit.stat = "f", star.cutoffs = c(0.05, 0.01, 0.001),
          digits = 4, out="table1.txt")
```



## Part 2 - CLM Practice

For the following questions, your task is to evaluate the Classical Linear Model assumptions. It is not enough to say that an assumption is met or not met; instead, present evidence based on your background knowledge, visualizations, and numerical summaries.

The file `videos.txt` contains 9618 observations of videos shared on YouTube. It was created by Cheng, Dale and Liu at Simon Fraser University. Please see [this link](http://netsg.cs.sfu.ca/youtubedata/) for details about how the data was collected.

You wish to run the following regression:

$$
ln(\text{views}) = \beta_0 + \beta_1 \text{rate}  + \beta_3 \text{length}
$$ 
The variables are as follows:

- `views`: the number of views by YouTube users.
- `rate`: This is the average of the ratings that the video received. You may think of this as a proxy for video quality. (Notice that this is different from the variable `ratings` which is a count of the total number of ratings that a video has received.)
- `length:` the duration of the video in seconds.


1. Evaluate the **IID** assumption.

2. Evaluate the **No perfect Colinearity** assumption.

3. Evaluate the **Linear Conditional Expectation:** assumption. 

4. Evaluate the **Homoskedastic Errors:** assumption.

5. Evaluate the **Normally Distributed Errors:** assumption.

